sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel","sap/ui/core/Fragment"],function(e,a,n,t){"use strict";return e.extend("aarinidemodetails.aarinidemodetails.controller.View1",{onInit:function(){this.getDemoDetails()},pressItem:function(e){var a=sap.ui.core.UIComponent.getRouterFor(this);var n=e.getSource().getBindingContext().getObject();var t=n.demoId;a.navTo("TargetDetail",{demoId:t})},getDemoDetails:function(){var e=this.ajaxCall("/catalog/Demo_Details","GET",{});var a=new sap.ui.model.json.JSONModel(e);a.setData(e);this.getView().byId("idDemoDetailsTable").setModel(a)},ajaxCall:function(e,a,n){var t;$.ajax({url:e,type:a,data:n,async:false,success:function(e){console.log(e.value);t=e.value},error:function(e){console.log(`Error ${e}`)}});return t},onSearch:function(e){var t=[];var i=e.getSource().getValue();if(i&&i.length>0){var o=new a("applicationName",n.Contains,i);var r=new a("applicationAreaName",n.Contains,i);var s=new a("subAreaName",n.Contains,i);var l=new a("industry",n.Contains,i);var d=new a("pointOfContact",n.Contains,i);var c=new a({filters:[o,r,s,l,d],and:false});t.push(c)}var m=this.byId("idDemoDetailsTable");var u=m.getBinding("items");u.filter(t,"Application")},handleOpen:function(){var e=this;if(!this.pDialog){this.pDialog=this.loadFragment({name:"aarinidemodetails.aarinidemodetails.view.applicationDetails"})}this.pDialog.then(function(a){a.open();e.setModelToDialog(a)})},pressCancel:function(){this.pDialog.then(function(e){e.close()})},setModelToDialog:function(e){var a=this.ajaxCall("/catalog/Application_Area","GET",{});var n=this.ajaxCall("/catalog/Sub_Area","GET",{});var t=[{key:"Aerospace and Defense",name:"Aerospace and Defense"},{key:"Agribusiness",name:"Agribusiness"},{key:"Automotive",name:"Automotive"},{key:"Banking",name:"Banking"},{key:"Building Materials",name:"Building Materials"},{key:"Cargo, Transportation, and Logistics",name:"Cargo, Transportation, and Logistics"},{key:"Chemicals",name:"Chemicals"},{key:"Consumer Products",name:"Consumer Products"},{key:"Defense and Security",name:"Defense and Security"},{key:"Engineering, Construction, and Operations",name:"Engineering, Construction, and Operations"},{key:"Fashion",name:"Fashion"},{key:"Federal, National, and Central Government",name:"Federal, National, and Central Government"},{key:"Healthcare",name:"Healthcare"},{key:"High Tech",name:"High Tech"},{key:"Higher Education and Research",name:"Higher Education and Research"},{key:"Industrial Manufacturing",name:"Industrial Manufacturing"},{key:"Insurance",name:"Insurance"},{key:"Life Sciences",name:"Life Sciences"},{key:"Media",name:"Media"},{key:"Mill Products",name:"Mill Products"},{key:"Mining",name:"Mining"},{key:"Oil, Gas, and Energy",name:"Oil, Gas, and Energy"}];var i={demoId:"",applicationAreaName:a,subAreaName:n,industry:t,applicationName:"",description:"",videoLink:"",diagramLink:[],demoCreationDate:"",demoCreatedBy:"",pointOfContact:""};var o=new sap.ui.model.json.JSONModel(i);o.setData(i);e.setModel(o)},pressSubmit:function(e){var a=e.getSource().getParent().getModel().getData();a.demoId=Math.random().toString(16).slice(2);a.demoCreationDate=new Date(a.demcatalogoCreationDate);a.applicationAreaName=this.getView().byId("applicationAreaName")._getSelectedItemText();a.subAreaName=this.getView().byId("subAreaName")._getSelectedItemText();a.industry=this.getView().byId("industry")._getSelectedItemText();a=JSON.stringify(a);var n={url:"/catalog/Demo_Details",method:"POST",timeout:0,headers:{"Content-Type":"application/json"},data:a};var t=this;$.ajax(n).done(function(e){console.log(e);$.each(t._oFiles,(a,n)=>{var i={fileName:n.name};t.createImageEntity(e.demoId,i,n)});t.getDemoDetails();t.pressCancel()}).fail(function(e){console.log(e)})},createImageEntity:function(e,a,n){var t=this;var i={url:`/catalog/Demo_Details('${e}')/diagramLink`,method:"POST",timeout:0,headers:{"Content-Type":"application/json"},data:JSON.stringify(a)};$.ajax(i).done(function(e){t.updateImageEntity(e.parent_demoid,e.ID,n)})},updateImageEntity:function(e,a,n){const t=new FormData;t.append("file",n);fetch(`/catalog/Demo_Details('${e}')/diagramLink(${a})/image`,{method:"PUT",body:n})},handleFilePathChange:function(e){this._oFiles=e.getParameter("files")}})});